# Resume å…¬é–‹é€£çµå’Œ QR Code åŠŸèƒ½

## âœ… å®Œæˆå…§å®¹

åœ¨ Resume é é¢åŠ å…¥äº†**å…¬é–‹å±¥æ­·é€£çµå’Œ QR Code** é¡¯ç¤ºåŠŸèƒ½,è®“ä½¿ç”¨è€…å¯ä»¥:
1. éš¨æ™‚æŸ¥çœ‹å…¬é–‹å±¥æ­·çš„ URL
2. å¿«é€Ÿè¤‡è£½é€£çµåˆ†äº«çµ¦ä»–äºº
3. é¡¯ç¤º QR Code ä¾›æƒæ
4. ç›´æ¥é–‹å•Ÿå…¬é–‹é é¢é è¦½

---

## ğŸ¯ åŠŸèƒ½ç‰¹é»

### 1. å…¬é–‹å±¥æ­·è³‡è¨Šå¡ç‰‡

ç•¶ä½¿ç”¨è€…å·²ç™¼å¸ƒå±¥æ­·æ™‚,æœƒåœ¨é é¢é ‚éƒ¨é¡¯ç¤ºä¸€å€‹é†’ç›®çš„è³‡è¨Šå¡ç‰‡:

**å…¬é–‹ç‹€æ…‹ (is_public = true)**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ”— å…¬é–‹ä¸­ã®å±¥æ­´æ›¸  [å…¬é–‹]                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ”— https://cafka.jp/r/john-doe-abc123      â”‚
â”‚    [ã‚³ãƒ”ãƒ¼]                                 â”‚
â”‚                                            â”‚
â”‚ [å…¬é–‹ãƒšãƒ¼ã‚¸ã‚’è¦‹ã‚‹] [QRã‚³ãƒ¼ãƒ‰]                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**éå…¬é–‹ç‹€æ…‹ (is_public = false)**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ”’ éå…¬é–‹ã®å±¥æ­´æ›¸                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ å±¥æ­´æ›¸ã¯éå…¬é–‹ãƒ¢ãƒ¼ãƒ‰ã§ä¿å­˜ã•ã‚Œã¦ã„ã¾ã™        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2. QR Code å°è©±æ¡†

é»æ“Šã€ŒQRã‚³ãƒ¼ãƒ‰ã€æŒ‰éˆ•æœƒå½ˆå‡ºå°è©±æ¡†,é¡¯ç¤º:
- 300x300 çš„ QR Code åœ–ç‰‡
- å®Œæ•´çš„å…¬é–‹ URL
- è¤‡è£½ URL æŒ‰éˆ•

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ QRã‚³ãƒ¼ãƒ‰                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ã“ã®QRã‚³ãƒ¼ãƒ‰ã‚’ã‚¹ã‚­ãƒ£ãƒ³ã—ã¦          â”‚
â”‚ å±¥æ­´æ›¸ã‚’è¡¨ç¤ºã§ãã¾ã™                â”‚
â”‚                                  â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚ â”‚                  â”‚            â”‚
â”‚ â”‚   [QR CODE]      â”‚            â”‚
â”‚ â”‚                  â”‚            â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                                  â”‚
â”‚ https://cafka.jp/r/john-doe      â”‚
â”‚                                  â”‚
â”‚ [é–‰ã˜ã‚‹] [URLã‚’ã‚³ãƒ”ãƒ¼]            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“ æŠ€è¡“å¯¦ä½œ

### ä¿®æ”¹çš„æª”æ¡ˆ

1. `/libs/hooks/useResume.ts` - æ“´å±• hook åŠŸèƒ½
2. `/app/dashboard/resume/page.tsx` - åŠ å…¥ UI å…ƒä»¶

### useResume Hook æ“´å±•

#### æ–°å¢çš„ç‹€æ…‹å’Œå‹åˆ¥

```typescript
export interface PublishedResumeInfo {
  id: number;
  is_public: boolean;
  public_url_slug: string | null;
  published_at: string;
  updated_at: string;
}

export interface UseResumeReturn {
  // ... åŸæœ‰çš„
  publishedResume: PublishedResumeInfo | null;  // æ–°å¢
  publicUrl: string | null;                     // æ–°å¢
  fetchPublishedResume: () => Promise<void>;    // æ–°å¢
}
```

#### æ–°å¢çš„åŠŸèƒ½

1. **fetchPublishedResume()** - ç²å–å…¬é–‹å±¥æ­·è³‡è¨Š
   ```typescript
   const fetchPublishedResume = useCallback(async () => {
     const response = await fetch('/api/resume/published');
     const { data } = await response.json();
     setPublishedResume(data);
   }, []);
   ```

2. **publicUrl** - è¨ˆç®—å…¬é–‹ URL
   ```typescript
   const publicUrl = useMemo(() => {
     if (!publishedResume?.is_public || !publishedResume?.public_url_slug) {
       return null;
     }
     return `/r/${publishedResume.public_url_slug}`;
   }, [publishedResume]);
   ```

3. **è‡ªå‹•åˆ·æ–°** - ç™¼å¸ƒå¾Œè‡ªå‹•åˆ·æ–°å…¬é–‹å±¥æ­·è³‡è¨Š
   ```typescript
   // åœ¨ publishResume æˆåŠŸå¾Œ
   await fetchPublishedResume();
   ```

### UI å…ƒä»¶

#### 1. å…¬é–‹å±¥æ­·è³‡è¨Šå¡ç‰‡

- ä½ç½®: åœ¨ Tab å°èˆªä¹‹å‰
- æ¢ä»¶: `publishedResume` å­˜åœ¨æ™‚é¡¯ç¤º
- æ¨£å¼: æ¼¸å±¤èƒŒæ™¯ + ä¸»è‰²é‚Šæ¡† (from-primary/5 to-primary/10)

**å…ƒä»¶çµæ§‹:**
```tsx
{publishedResume && (
  <div className="bg-gradient-to-br from-primary/5 to-primary/10 ...">
    {/* æ¨™é¡Œ + ç‹€æ…‹æ¨™ç±¤ */}
    <div className="flex items-center gap-2">
      <Share2 />
      <h3>{is_public ? "å…¬é–‹ä¸­ã®å±¥æ­´æ›¸" : "éå…¬é–‹ã®å±¥æ­´æ›¸"}</h3>
      {is_public && <span className="badge badge-success">å…¬é–‹</span>}
    </div>
    
    {/* URL é¡¯ç¤ºå€ */}
    {is_public && (
      <div className="flex items-center">
        <code>{fullUrl}</code>
        <button onClick={handleCopyUrl}>ã‚³ãƒ”ãƒ¼</button>
      </div>
    )}
    
    {/* æ“ä½œæŒ‰éˆ• */}
    <button onClick={handleOpenPublic}>å…¬é–‹ãƒšãƒ¼ã‚¸ã‚’è¦‹ã‚‹</button>
    <button onClick={() => setShowQRDialog(true)}>QRã‚³ãƒ¼ãƒ‰</button>
  </div>
)}
```

#### 2. QR Code å°è©±æ¡†

ä½¿ç”¨ Google Chart API ç”Ÿæˆ QR Code:
```typescript
const qrCodeUrl = `https://api.qrserver.com/v1/create-qr-code/?size=300x300&data=${encodeURIComponent(fullUrl)}`;
```

**å„ªé»:**
- âœ… ä¸éœ€è¦å®‰è£é¡å¤–çš„ npm å¥—ä»¶
- âœ… å³æ™‚ç”Ÿæˆ,ç„¡éœ€å¾Œç«¯è™•ç†
- âœ… å¯é çš„ç¬¬ä¸‰æ–¹æœå‹™
- âœ… æ”¯æ´å¤šç¨®å°ºå¯¸å’Œæ ¼å¼

#### 3. è¼”åŠ©å‡½æ•¸

```typescript
// è¤‡è£½ URL åˆ°å‰ªè²¼ç°¿
const handleCopyUrl = () => {
  navigator.clipboard.writeText(fullUrl);
  toast.success("URLã‚’ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ");
};

// åœ¨æ–°è¦–çª—é–‹å•Ÿå…¬é–‹é é¢
const handleOpenPublic = () => {
  window.open(publicUrl, '_blank');
};
```

---

## ğŸ¨ UI/UX è¨­è¨ˆè€ƒé‡

### è¦–è¦ºå±¤æ¬¡

1. **è³‡è¨Šå¡ç‰‡æœ€é¡¯çœ¼**
   - ä½¿ç”¨æ¼¸å±¤èƒŒæ™¯å’Œä¸»è‰²é‚Šæ¡†
   - æ”¾åœ¨é é¢é ‚éƒ¨,Tab å°èˆªä¹‹å‰
   - å…¬é–‹ç‹€æ…‹æœ‰ç¶ è‰²æ¨™ç±¤

2. **URL æ˜“æ–¼è¤‡è£½**
   - ä½¿ç”¨ `<code>` æ¨™ç±¤é¡¯ç¤º
   - æ—é‚Šæœ‰æ˜é¡¯çš„ã€Œã‚³ãƒ”ãƒ¼ã€æŒ‰éˆ•
   - è¤‡è£½æˆåŠŸé¡¯ç¤º toast æç¤º

3. **QR Code å¤§ä¸”æ¸…æ™°**
   - 300x300 åƒç´ çš„å¤§å°
   - ç™½è‰²èƒŒæ™¯çªå‡º QR Code
   - ä¸‹æ–¹é¡¯ç¤ºå®Œæ•´ URL ä¾›åƒè€ƒ

### äº’å‹•æµç¨‹

**æµç¨‹ 1: åˆ†äº«çµ¦çµé ­**
```
1. ä½¿ç”¨è€…: é»æ“Šã€Œå…¬é–‹ãƒšãƒ¼ã‚¸ã‚’è¦‹ã‚‹ã€é è¦½
2. ç¢ºèªå…§å®¹æ­£ç¢º
3. é»æ“Šã€Œã‚³ãƒ”ãƒ¼ã€è¤‡è£½ URL
4. è²¼åˆ° Email æˆ–è¨Šæ¯ä¸­ç™¼é€
```

**æµç¨‹ 2: é¢è©¦æ™‚å±•ç¤º**
```
1. ä½¿ç”¨è€…: é»æ“Šã€ŒQRã‚³ãƒ¼ãƒ‰ã€
2. å°‡ QR Code å±•ç¤ºçµ¦é¢è©¦å®˜
3. é¢è©¦å®˜æƒæ QR Code
4. ç›´æ¥åœ¨æ‰‹æ©Ÿä¸ŠæŸ¥çœ‹å±¥æ­·
```

---

## ğŸ“± éŸ¿æ‡‰å¼è¨­è¨ˆ

### æ¡Œé¢ç‰ˆ
- URL å®Œæ•´é¡¯ç¤º
- æŒ‰éˆ•ä¸¦æ’é¡¯ç¤º
- QR Code åœ¨å°è©±æ¡†ä¸­å¤®

### æ‰‹æ©Ÿç‰ˆ
- URL å¯èƒ½æœƒæŠ˜è¡Œæˆ–æˆªæ–·
- æŒ‰éˆ•å¯ä»¥å‚ç›´æ’åˆ—
- QR Code é©æ‡‰å°è¢å¹• (ç¸®å°åˆ° 240x240)

---

## ğŸ”’ å®‰å…¨è€ƒé‡

### 1. åªæœ‰å…¬é–‹å±¥æ­·æ‰é¡¯ç¤º URL
```typescript
{publishedResume.is_public && publicUrl && (
  // é¡¯ç¤º URL å’Œæ“ä½œ
)}
```

### 2. RLS ä¿è­·
- API `/api/resume/published` å— RLS ä¿è­·
- åªæœ‰æœ¬äººå¯ä»¥æŸ¥è©¢è‡ªå·±çš„ published resume è³‡è¨Š
- å…¬é–‹é é¢ `/r/[slug]` ä»»ä½•äººå¯è¨ªå• (ç•¶ is_public=true)

### 3. URL é©—è­‰
- `public_url_slug` å¿…é ˆå­˜åœ¨
- `is_public` å¿…é ˆç‚º true
- å¦å‰‡ä¸é¡¯ç¤ºé€£çµå’Œ QR Code

---

## ğŸ§ª æ¸¬è©¦æ¸…å–®

- [ ] ç™¼å¸ƒå±¥æ­·å¾Œ,è³‡è¨Šå¡ç‰‡æ­£ç¢ºé¡¯ç¤º
- [ ] å…¬é–‹ç‹€æ…‹é¡¯ç¤ºå®Œæ•´ URL
- [ ] éå…¬é–‹ç‹€æ…‹åªé¡¯ç¤ºæç¤ºæ–‡å­—
- [ ] è¤‡è£½ URL åŠŸèƒ½æ­£å¸¸
- [ ] é»æ“Šã€Œå…¬é–‹ãƒšãƒ¼ã‚¸ã‚’è¦‹ã‚‹ã€åœ¨æ–°è¦–çª—é–‹å•Ÿ
- [ ] QR Code æ­£ç¢ºç”Ÿæˆ
- [ ] æƒæ QR Code å¯ä»¥è¨ªå•å…¬é–‹é é¢
- [ ] é‡æ–°ç™¼å¸ƒå¾Œè³‡è¨Šè‡ªå‹•æ›´æ–°
- [ ] åœæ­¢å…¬é–‹å¾Œå¡ç‰‡ç‹€æ…‹æ”¹è®Š

---

## ğŸ’¡ æœªä¾†æ”¹é€²å»ºè­°

### 1. ä¸‹è¼‰ QR Code
```typescript
const handleDownloadQR = () => {
  const link = document.createElement('a');
  link.href = qrCodeUrl;
  link.download = 'resume-qr-code.png';
  link.click();
};
```

### 2. è‡ªè¨‚ QR Code æ¨£å¼
- åŠ å…¥ logo
- ä¿®æ”¹é¡è‰²
- èª¿æ•´å°ºå¯¸

### 3. åˆ†äº«çµ±è¨ˆ
```typescript
interface PublishedResumeInfo {
  // ... ç¾æœ‰æ¬„ä½
  view_count: number;      // æŸ¥çœ‹æ¬¡æ•¸
  share_count: number;     // åˆ†äº«æ¬¡æ•¸
  last_viewed_at: string;  // æœ€å¾ŒæŸ¥çœ‹æ™‚é–“
}
```

### 4. å¤šç¨®åˆ†äº«æ–¹å¼
```tsx
<button onClick={shareToLinkedIn}>LinkedInã§å…±æœ‰</button>
<button onClick={shareToTwitter}>Twitterã§å…±æœ‰</button>
<button onClick={shareByEmail}>ãƒ¡ãƒ¼ãƒ«ã§å…±æœ‰</button>
```

### 5. çŸ­ç¶²å€
```typescript
// ç”ŸæˆçŸ­ç¶²å€
const shortUrl = await createShortUrl(publicUrl);
// ä¾‹: https://cafka.jp/r/abc123 â†’ https://cfk.jp/abc123
```

---

## ğŸ¯ ä½¿ç”¨æƒ…å¢ƒ

### æƒ…å¢ƒ 1: ç¶²è·¯æ±‚è·
```
ä½¿ç”¨è€…åœ¨æ±‚è·ç¶²ç«™çœ‹åˆ°å¥½è·ç¼º
â†’ è¤‡è£½å…¬é–‹å±¥æ­· URL
â†’ è²¼åˆ°ã€Œå€‹äººç¶²ç«™ã€æ¬„ä½
â†’ HR å¯ä»¥ç›´æ¥é»æ“ŠæŸ¥çœ‹å®Œæ•´å±¥æ­·
```

### æƒ…å¢ƒ 2: é¢è©¦æ™‚è£œå……è³‡æ–™
```
é¢è©¦å®˜:ã€Œå¯ä»¥çœ‹ä¸€ä¸‹ä½ çš„ä½œå“é›†å—?ã€
â†’ ä½¿ç”¨è€…å±•ç¤º QR Code
â†’ é¢è©¦å®˜æƒæ
â†’ åœ¨æ‰‹æ©Ÿä¸ŠæŸ¥çœ‹å®Œæ•´å±¥æ­·å’Œä½œå“
```

### æƒ…å¢ƒ 3: ç¤¾ç¾¤åª’é«”åˆ†äº«
```
ä½¿ç”¨è€…åœ¨ LinkedIn å€‹äººç°¡ä»‹ä¸­
â†’ åŠ å…¥å…¬é–‹å±¥æ­·é€£çµ
â†’ äººè„ˆå¯ä»¥æŸ¥çœ‹è©³ç´°ç¶“æ­·
â†’ å¢åŠ æ›å…‰æ©Ÿæœƒ
```

### æƒ…å¢ƒ 4: çµé ­åˆä½œ
```
çµé ­:ã€Œå¯ä»¥çµ¦æˆ‘ä½ çš„å±¥æ­·å—?ã€
â†’ ä½¿ç”¨è€…è¤‡è£½å…¬é–‹é€£çµ
â†’ é€é Email ç™¼é€
â†’ çµé ­ç›´æ¥ç·šä¸ŠæŸ¥çœ‹,ä¸éœ€è¦ä¸‹è¼‰æª”æ¡ˆ
```

---

## ğŸ“Š æ•ˆç›Šåˆ†æ

### å°ä½¿ç”¨è€…çš„å¥½è™•

1. **æ–¹ä¾¿åˆ†äº«** â­â­â­â­â­
   - ä¸éœ€è¦æ¯æ¬¡éƒ½ä¸‹è¼‰ PDF
   - ä¸€éµè¤‡è£½é€£çµ
   - QR Code æƒææ›´å¿«é€Ÿ

2. **éš¨æ™‚æ›´æ–°** â­â­â­â­â­
   - æ›´æ–°å±¥æ­·å¾Œ,é€£çµå…§å®¹è‡ªå‹•æ›´æ–°
   - ä¸éœ€è¦é‡æ–°ç™¼é€çµ¦æ‰€æœ‰äºº

3. **å°ˆæ¥­å½¢è±¡** â­â­â­â­
   - ç¾ä»£åŒ–çš„ç·šä¸Šå±¥æ­·å±•ç¤º
   - æ¯”å‚³çµ± PDF æ›´æœ‰ç§‘æŠ€æ„Ÿ

4. **è¿½è¹¤å¯èƒ½** â­â­â­
   - æœªä¾†å¯ä»¥çœ‹åˆ°èª°æŸ¥çœ‹äº†å±¥æ­·
   - äº†è§£å“ªå€‹é€£çµè¢«åˆ†äº«æœ€å¤š

### å°ç”¢å“çš„å¥½è™•

1. **å·®ç•°åŒ–** - ä¸åŒæ–¼å‚³çµ±æ±‚è·ç¶²ç«™
2. **é»è‘—åº¦** - ä½¿ç”¨è€…éœ€è¦æŒçºŒæ›´æ–°å’Œåˆ†äº«
3. **ç—…æ¯’å¼å‚³æ’­** - é€éåˆ†äº«å¢åŠ æ›å…‰
4. **æ•¸æ“šæ”¶é›†** - å¯ä»¥åˆ†æå±¥æ­·è¢«æŸ¥çœ‹çš„æƒ…æ³

---

## ğŸ”— ç›¸é—œæª”æ¡ˆ

- `/libs/hooks/useResume.ts` - Hook å¯¦ä½œ
- `/app/dashboard/resume/page.tsx` - UI å¯¦ä½œ
- `/app/api/resume/published/route.ts` - API endpoint
- `/app/api/resumes/[id]/publish/route.ts` - ç™¼å¸ƒ API

---

## ğŸ“– æŠ€è¡“åƒè€ƒ

- [Google Chart API - QR Codes](https://developers.google.com/chart/infographics/docs/qr_codes)
- [Clipboard API](https://developer.mozilla.org/en-US/docs/Web/API/Clipboard_API)
- [Window.open()](https://developer.mozilla.org/en-US/docs/Web/API/Window/open)

